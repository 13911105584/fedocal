{% extends "master.html" %}
{% from "_formhelpers.html" import render_field %}

{% block title %} {{ calendar.calendar_name }} {% endblock %}

{% block content_titles %}
    <h1> Fedora Calendar </h1>

    <h2> {{ calendar.calendar_name }} </h2>
    <p>
        {{ calendar.calendar_description }}
    </p>
{% endblock %}

{% block content %}

<!-- start sidebar -->
<div id="left-sidebar">
    <h4>Calendars</h4>
    <ul class="checkmark-list">
        {% for calendar in calendars %}
        <li>
            <a href="{{url_for('calendar',
                calendar=calendar.calendar_name)}}">
                {{ calendar.calendar_name }}
            </a>
        </li>
        {% endfor %}
    </ul>
    <h4> User </h4>
    {% if not g.fas_user %}
        <form action="{{ url_for('auth_login') }}" method="post">
            <p>Log in using your <a href="{{ config.FAS_BASE_URL }}">
                Fedora Accounts System</a> account.
            </p>
            {{ render_field(auth_form.username) }}
            {{ render_field(auth_form.password) }}
            <p class="buttons indent">
                <input type="submit" class="submit positive" value="Log in">
            </p>
            {{ auth_form.csrf_token }}
        </form>
    {% else %}
        <p> Welcome, {{ g.fas_user.username }}</p>
        <ul class="checkmark-list">
            <li><a href=""> Add a meeting </a></li>
            <li><a href=""> Manage your meeting </a></li>
            <li><a href="{{ url_for('auth_logout') }}"> Log-out </a></li>
        </ul>
    {% endif %}
    {% if admin %}
        <h4> Admin </h4>
        <ul>
            <li>
            <a href="{{ url_for('add_calendar') }}"> Add a calendar </a>
            </li>
        </ul>
    {% endif %}
</div>
<!-- end sidebar -->

<p>
    <a href="{{url_for('calendar_fullday', calendar=calendar.calendar_name,
        year=prev_week.year, month=prev_week.month, day=prev_week.day)}}">
         &lt;&lt; Previous week
    </a> |
    <a href="{{url_for('calendar', calendar=calendar.calendar_name)}}">
         current week
    </a> |
    <a href="{{url_for('calendar_fullday', calendar=calendar.calendar_name,
        year=next_week.year, month=next_week.month, day=next_week.day)}}">
        Next week &gt;&gt;
    </a>
</p>
<div id='agenda'>
    <table>
        <tr>
            <th></th>
            {% for day in weekdays %}
            <th> {{ day }}</th>
            {% endfor %}
        </tr>
        {% for time_entry in meetings |sort %}
        <tr>
            <td class="time">{{ time_entry }}</td>
            {% for meeting in meetings[time_entry] %}
                {% if meeting %}
                <td> {{ meeting.meeting_name }} </td>
                {% else %}
                <td></td>
                {% endif %}
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
</div>

{% endblock %}
